<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù…ØªØ­Ø§Ù† Ø¬ØºØ±Ø§ÙÙŠØ§</title>
  <style>
    body {
      font-family: Tahoma, Arial, sans-serif;
      background: linear-gradient(to right, #74ebd5, #ACB6E5);
      margin: 0; padding: 0;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: 30px auto;
      background: #fff;
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      animation: fadeIn 1s ease-in-out;
    }
    h1 { color: #333; margin-bottom: 15px; }
    .question { text-align: right; margin: 15px 0; }
    .options { margin-right: 20px; }
    button {
      background: #4CAF50;
      color: white;
      padding: 12px 25px;
      margin: 20px 0;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 18px;
      transition: transform 0.2s ease;
    }
    button:hover { transform: scale(1.05); background: #45a049; }
    .result {
      display: none;
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
      color: #2c3e50;
      animation: popUp 1s ease;
    }
    .leaderboard {
      margin-top: 30px;
      text-align: center;
    }
    .leaderboard h2 {
      color: #222;
      margin-bottom: 10px;
    }
    .leaderboard table {
      width: 100%;
      border-collapse: collapse;
    }
    .leaderboard th, .leaderboard td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(20px);}
      to {opacity:1; transform:translateY(0);}
    }
    @keyframes popUp {
      0% {transform:scale(0.5); opacity:0;}
      100% {transform:scale(1); opacity:1;}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§</h1>

    <div id="examForm">
      <label>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
      <input type="text" id="studentName" required><br><br>

      <label>
        <input type="checkbox" id="privacy" required>
        Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©
      </label>

      <div id="questions"></div>

      <button onclick="submitExam()">ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
    </div>

    <div class="result" id="resultBox"></div>

    <div class="leaderboard" id="leaderboardBox" style="display:none;">
      <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚ÙŠÙ†</h2>
      <table id="leaderboardTable">
        <thead>
          <tr><th>Ø§Ù„ØªØ±ØªÙŠØ¨</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø©</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbz54xyCFon5TyorHDtZWqswnnOFzBsQQo5vx9w60GDn5u77yXCZ2lqGpCzOP5cuPirDPQ/exec"; // Ø¶Ø¹ Ù„ÙŠÙ†Ùƒ Ø§Ù„ÙˆÙŠØ¨ Ø¢Ø¨ Ø¨ØªØ§Ø¹Ùƒ

// Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©)
const questions = [
  {q:"1- Ø§ÙƒØ¨Ø± Ø§Ù„Ù‚Ø§Ø±Ø§Øª Ù…ÙˆØ±ÙÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ¯ÙŠÙ…ÙˆØºØ±Ø§ÙÙŠØ§ ØªÙ‚Ø¹ ÙÙ‰ Ø§Ù„Ù†ØµÙ .... Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¹Ø§Ù„Ù…", 
   options:["Ø§Ù„Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø´Ø±Ù‚ÙŠ","Ø§Ù„Ø´Ù…Ø§Ù„ Ø§Ù„Ø´Ø±Ù‚ÙŠ","Ø¬Ù†ÙˆØ¨ ØºØ±Ø¨ÙŠ","Ø´Ù…Ø§Ù„ ØºØ±Ø¨ÙŠ"], ans:1},
  {q:"2- Ø§Ù‰ Ù…Ù† Ø§Ù„Ù‚Ø§Ø±Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø¨ÙŠØ³Ø©", 
   options:["Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©","Ø£ÙˆØ±ÙˆØ¨Ø§","Ø£ÙØ±ÙŠÙ‚ÙŠØ§","Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©"], ans:3},
  // ... ÙƒÙ…Ù„ Ø¨Ø§Ù‚ÙŠ 25 Ø³Ø¤Ø§Ù„ Ø¨Ù†ÙØ³ Ø§Ù„Ø´ÙƒÙ„ ...
];

// Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„ØµÙØ­Ø©
const qDiv = document.getElementById("questions");
questions.forEach((item, i) => {
  let div = document.createElement("div");
  div.className = "question";
  div.innerHTML = `<p>${item.q}</p>`;
  item.options.forEach((opt, j) => {
    div.innerHTML += `
      <label class="options">
        <input type="radio" name="q${i}" value="${j}"> ${opt}
      </label><br>`;
  });
  qDiv.appendChild(div);
});

function submitExam() {
  const name = document.getElementById("studentName").value.trim();
  const privacy = document.getElementById("privacy").checked;
  if (!name) return alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ");
  if (!privacy) return alert("Ù„Ø§Ø¨Ø¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©");

  let score = 0;
  questions.forEach((item,i)=>{
    const ans = document.querySelector(`input[name=q${i}]:checked`);
    if (ans && parseInt(ans.value) === item.ans) score++;
  });

  // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥Ù„Ù‰ Google Apps Script
  fetch(scriptURL + "?action=submit&name=" + encodeURIComponent(name) + "&score=" + score, {
    method: "GET",
    mode: "cors"
  })
  .then(r => r.json())
  .then(data => {
    document.getElementById("examForm").style.display = "none";
    let resultBox = document.getElementById("resultBox");
    resultBox.style.display = "block";
    resultBox.innerHTML = `ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ ${name}! Ø¯Ø±Ø¬ØªÙƒ: ${score} Ù…Ù† ${questions.length} <br> ØªØ±ØªÙŠØ¨Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${data.rank}`;
    showLeaderboard(data.leaderboard);
  })
  .catch(err=>{
    console.error("Error:",err);
    alert("ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
  });
}

function showLeaderboard(leaderboard){
  const box = document.getElementById("leaderboardBox");
  const tbody = document.querySelector("#leaderboardTable tbody");
  tbody.innerHTML = "";
  leaderboard.forEach((row,i)=>{
    tbody.innerHTML += `<tr>
      <td>${i+1}</td><td>${row.name}</td><td>${row.score}</td>
    </tr>`;
  });
  box.style.display = "block";
}
</script>
</body>
</html>
